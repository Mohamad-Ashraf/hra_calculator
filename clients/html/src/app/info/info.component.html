<div class="main-content">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-body">
          <div class="container hra_results">
            <div *ngIf="showErrors">
            <ngb-alert type="danger" (close)="closeAlert()" [ngStyle]="{'background-color': dangerColorCode}">
              <p class="mb-0" *ngFor="let error of errors">
                {{ error }}
              </p>
            </ngb-alert>
            </div>
            <form [formGroup]="hraForm" (ngSubmit)="onSubmit()">
              <div class="tab" [hidden]="!(currentTab === 0)">
                <h1>About You</h1>
                <hr>
                <div class="d-inline-flex ie-flex">
                  <div class="col-md-2">
                    <img src="../../assets/images/about_you.png" alt="about you picture" height="100"/>
                  </div>
                  <div class="col-md-12">
                    <p class="step-desription">
                      <strong>
                        Enter the following information for the family member
                        who is offered the HRA.
                        <ng-template #popContentFamily>
                          <div class="tooltip-italic">
                            This is the family member whose employer or former employer (if family member is a retiree) is offering the HRA.
                          </div>
                        </ng-template>
                        <sup [ngbPopover]="popContentFamily">
                          <i class="fas fa-question-circle "></i>
                        </sup>
                      </strong>
                    </p>
                  </div>
                </div>
                <div class="form-group">
                  <br/>
                  <p>
                    <strong>
                      Place of Residence
                      <ng-template #popContentResidence>
                        <div class="tooltip-italic">Enter the family member’s place of residence, even if the employer is located somewhere else.
                        </div>
                      </ng-template>
                      <sup [ngbPopover]="popContentResidence">
                        <i class="fas fa-question-circle"></i>
                      </sup>
                    </strong>
                  </p>
                </div>
                <div class="form-group">
                  <div class="input-group">
                    <label class="col-sm-3 col-form-label col-form-label-sm" for="state">
                      State
                    </label>
                    <div class="col-sm-4 state-align">
                      <input type="hidden" formControlName="state" id="state">
                      {{ this.hraForm.value.state }}
                      <ng-template #popContentState>
                        <div class="tooltip-italic">
                          If you are not a resident of this state, please visit <a href="https://www.healthcare.gov/get-coverage/" target="_blank">https://www.healthcare.gov/get-coverage/</a> to find the Marketplace in your state.
                        </div>
                      </ng-template>
                      <sup [ngbPopover]="popContentState" >
                        <i class="fas fa-question-circle"></i>
                      </sup>
                      <div *ngIf="hraForm.controls['state'].invalid && (hraForm.controls['state'].dirty || hraForm.controls['state'].touched)" class="alert alert-danger" [ngStyle]="{'background-color': dangerColorCode}">
                        <div *ngIf="hraForm.controls['state'].errors.required">
                          State is required.
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div *ngIf="showZipcode">
                  <div class="form-group">
                    <div textEntryField
                      class="input-group"
                      [settings]="zipcodeSettings"
                      controlName="zipcode"
                      [parentFormControl]="hraForm"
                      controlId="zipcode"
                      [dangerColorCode]="dangerColorCode"
                      (keypress)="numberOnly($event)"
                      requiredErrorText="Zipcode is required."
                      minlength="5"
                      maxlength="5"
                      lengthErrorText="Zipcode should be 5 digits."
                      (input)="getCountyInfo()"
                    >
                    </div>
                  </div>
                </div>

                <div *ngIf="showCounty">
                  <div class="form-group">
                    <div dropdown
                      class="input-group"
                      controlId="county"
                      controlName="county"
                      [settings]="countySettings"
                      [parentFormControl]="hraForm"
                      [dangerColorCode]="dangerColorCode"
                      requiredErrorText="County is required."
                      placeHolderText={{countyPlaceHolder}}
                      [dropdownOptions]="countyOptions"
                      [isDisabled]="isCountyDisabled ? '' : null"
                    >
                    </div>
                  </div>
                </div>
                <div *ngIf="showDob" >
                  <div class="form-group">
                    <p>
                      <strong>Date Of Birth</strong>
                    </p>
                  </div>
                  <div class="form-group">
                    <div class="input-group">
                      <label class="col-sm-3 col-form-label col-form-label-sm" for="dob">MM/DD/YYYY</label>
                      <div class="col-sm-4">
                        <div class="input-group">
                          <input class="form-control"
                            id="dob"
                            placeholder="mm/dd/yyyy"
                            name="dp"
                            ngbDatepicker #d="ngbDatepicker"
                            [minDate]="{year: 1900, month: 1, day: 1}"
                            [maxDate]="today"
                            formControlName="dob"
                            (input)="checkDateInput($event)"
                            validateDate validateDateFormat required>
                          <div class="input-group-append">
                            <button class="btn btn-outline-secondary" (click)="d.toggle()" type="button" aria-label="calender icon">
                              <i class="fas fa-calendar-alt"></i>
                            </button>
                          </div>
                        </div>
                        <div *ngIf="hraForm.controls['dob'].invalid && (hraForm.controls['dob'].dirty || hraForm.controls['dob'].touched)" class="input-group alert alert-danger" [ngStyle]="{'background-color': dangerColorCode}">
                          <div *ngIf="hraForm.controls['dob'].errors.required">
                            Date of Birth is required.
                          </div>
                          <div *ngIf="hraForm.controls['dob'].errors.invalidDate">
                            DOB must be between 01/01/1900 to Today.
                          </div>
                          <div *ngIf="hraForm.controls['dob'].errors.invalidDateFormat">
                            Please Enter Valid Date Format(MM/DD/YYYY)
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <p id="expected_household_income_form_description">
                    <strong>
                      Expected 2020 Household Income
                      <ng-template #popContentHouseholdIncome>
                        <div class="tooltip-italic">This is your household income before taxes. For most people, annual household income is the same as federal adjusted gross income that you enter on your federal income tax return (Form 1040).Specifically, household income is equal to adjusted gross income plus the following amounts: Social Security benefits that are excluded from gross income, interest from tax-exempt bonds, any foreign-source income excluded from gross income under section 911 of Internal Revenue Code (rare), and the income of dependents who are required to file a separate income tax return (rare).
                        </div>
                      </ng-template>
                      <sup [ngbPopover]="popContentHouseholdIncome">
                        <i class="fas fa-question-circle"></i>
                      </sup>
                    </strong>
                  </p>
                </div>
                <div class="form-group">
                  <div radioButtonField
                    class="input-group"
                    [settings]="householfFrequencySettings"
                    [span1Class]="(selectedHouseholdFrequency=='monthly')?'btn btn-outline-info active':'btn btn-outline-info'"
                    control1Value="monthly"
                    control1Label="Monthly"
                    [span2Class]="(selectedHouseholdFrequency=='annually')?'btn btn-outline-info active':'btn btn-outline-info'"
                    control2Value="annually"
                    control2Label="Annually"
                    controlId="household_frequency"
                    controlName="household_frequency"
                    [parentFormControl]="hraForm"
                    [dangerColorCode]="dangerColorCode"
                    (click1Event)="onHouseholdChange('monthly')"
                    (click2Event)="onHouseholdChange('annually')"
                    requiredErrorText="Frequency is required."
                  >
                  </div>
                </div>
                <div class="form-group">
                    <div dollarEntryField
                      class="input-group"
                      controlId="household_amount"
                      controlName="household_amount"
                      labelText="Amount"
                      [parentFormControl]="hraForm"
                      [dangerColorCode]="dangerColorCode"
                      [isDisabled]="(hraForm.controls['household_frequency'].value =='') ? '' : null"
                    >
                   </div>
                </div>
              </div>
              <div class="tab" [hidden]="!(currentTab === 1)">
                <h1>About the HRA You've Been Offered</h1>
                <hr/>
                <div class="d-inline-flex ie-flex">
                  <div>
                    <img src="../../assets/images/about_hra.png" alt="Profile picture" height="100"/>
                  </div>
                  <div class="col-md-11">
                    <p>
                      <strong>
                        Enter the following information about the HRA that you have been offered.
                      </strong>
                      All answers can be found in the HRA notice provided by the employer.
                    </p>
                  </div>
                </div>
                <div class="form-group">
                  <br/>
                  <div class="form-group">
                    <p>
                      <strong>Type</strong>
                    </p>
                  </div>
                  <div radioButtonField
                    class="input-group"
                    [span1Class]="(selectedHraType=='ichra')?'btn btn-outline-info active':'btn btn-outline-info'"
                    control1Value="ichra"
                    controlClass="col-sm-8"
                    control1Label="Individual Coverage HRA"
                    [span2Class]="(selectedHraType=='qsehra')?'btn btn-outline-info active':'btn btn-outline-info'"
                    control2Value="qsehra"
                    control2Label="Qualified Small Employer HRA (QSEHRA)"
                    controlId="hra_type"
                    controlName="hra_type"
                    [settings]="hraTypeSettings"
                    [parentFormControl]="hraForm"
                    [dangerColorCode]="dangerColorCode"
                    (click1Event)="onHraTypeChange('ichra')"
                    (click2Event)="onHraTypeChange('qsehra')"
                    requiredErrorText="Type of HRA is required."
                    displayToolTip=true
                    popContent="The type of HRA will appear prominently on the notice from the employer."
                  >
                  </div>
                </div>
                <div class="form-group">
                  <p>
                    <strong>Effective Period</strong>
                  </p>
                </div>
                <div class="form-group">
                  <div dropdown
                    class="input-group"
                    controlId="start_month"
                    controlName="start_month"
                    labelText="Start Month"
                    [parentFormControl]="hraForm"
                    [dangerColorCode]="dangerColorCode"
                    requiredErrorText="Start Month is required."
                    placeHolderText="Choose"
                    [dropdownOptions]="effectiveStartOptions"
                    formatDATE=true
                    displayToolTip=true
                    popContent="This is the first month the HRA is available to you."
                    (change)="setEffectiveEndOptions($event.target.value)"
                  >
                  </div>
                </div>

                <div class="form-group">
                  <div dropdown
                    class="input-group"
                    controlId="end_month"
                    controlName="end_month"
                    labelText="End Month"
                    [parentFormControl]="hraForm"
                    [dangerColorCode]="dangerColorCode"
                    placeHolderText="Choose"
                    requiredErrorText="End Month is required."
                    [dropdownOptions]="effectiveEndOptions"
                    formatDATE=true
                    displayToolTip=true
                    popContent="This is the last month the HRA is available to you."
                  >
                  </div>
                </div>
                <div class="form-group">
                  <p>
                    <strong>
                      Maximum Amount for Employee-Only Health Insurance
                      <ng-template #popContentHraAmount>
                        <div class="tooltip-italic">This is the amount the employer has offered to contribute to the HRA if you purchase health insurance for only the employee (not including other family members). Some employers provide one amount if only the employee enrolls in coverage (sometimes referred to as “self-only” coverage), and a larger amount if the employee plus other family members enroll in coverage. Enter the amount of the HRA if only the employee enrolls, even if you plan to enroll in family coverage.</div>
                      </ng-template>
                      <sup [ngbPopover]="popContentHraAmount">
                        <i class="fas fa-question-circle"></i>
                      </sup>
                    </strong>
                  </p>
                </div>
                <div class="form-group">
                  <div radioButtonField
                    class="input-group"
                    [span1Class]="(selectedHraFrequency=='monthly')?'btn btn-outline-info active' :'btn btn-outline-info'"
                    control1Value="monthly"
                    control1Label="Monthly"
                    [span2Class]="(selectedHraFrequency=='annually')?'btn btn-outline-info active':'btn btn-outline-info'"
                    control2Value="annually"
                    control2Label="Total"
                    controlId="hra_frequency"
                    controlName="hra_frequency"
                    [settings]="hraAmountFrequencySettings"
                    [parentFormControl]="hraForm"
                    [dangerColorCode]="dangerColorCode"
                    (click1Event)="onHraFrequencyChange('monthly')"
                    (click2Event)="onHraFrequencyChange('annually')"
                    requiredErrorText="Frequency is required."
                    displayToolTip=true
                    popContent="Choose <strong>Monthly Amount</strong> to enter the maximum amount the HRA would pay towards employee-only coverage per month. Choose <strong>Total Amount</strong> to enter the amount the HRA would pay towards employee-only coverage over the entire period between the start month and the end month."
                  >
                  </div>
                </div>
                <div class="form-group">
                    <div dollarEntryField
                    class="input-group"
                    controlId="hra_amount"
                    controlName="hra_amount"
                    labelText="Amount"
                    [parentFormControl]="hraForm"
                    [dangerColorCode]="dangerColorCode"
                    [isDisabled]="(hraForm.controls['household_frequency'].value =='') ? '' : null"
                  >
                 </div>
                </div>
              </div>

              <div style="overflow:auto;">
                <div style="float:left;">
                  <button [ngStyle]="{'background-color': primaryColorCode}" type="button" class="btn btn btn-md button-style card-color" [hidden]="(currentTab === 1)" routerLink="/home"> <i class="fas fa-arrow-circle-left fa-lg"> </i> Previous</button>
                </div>
                <div style="float:left;">
                  <button [ngStyle]="{'background-color': primaryColorCode}" type="button" class="btn btn btn-md button-style card-color" [hidden]="(currentTab === 0)" (click)="showTab(currentTab-1)"><i class="fas fa-arrow-circle-left fa-lg"> </i> Previous</button>
                </div>
                <div style="float:right;">
                  <button [ngStyle]="{'background-color': primaryColorCode}" type="button" class="btn btn btn-md button-style card-color" [hidden]="(currentTab === 1)"
                  (click)="showTab(currentTab+1)">Next <i class="fas fa-arrow-circle-right fa-lg"> </i></button>
                  <button [ngStyle]="{'background-color': primaryColorCode}" type="submit" class="btn btn btn-md button-style card-color" [hidden]="(currentTab != 1)" >Next <i class="fas fa-arrow-circle-right fa-lg"> </i></button>
                </div>
              </div>
              <!-- Circles which indicates the steps of the form: -->
              <div style="text-align:center;margin-top:40px;">
                <span [ngClass]="currentTab === 0 ? 'step active' : 'step'"></span>
                <span [ngClass]="currentTab === 1 ? 'step active' : 'step'"></span>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
